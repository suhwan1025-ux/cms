const { sequelize } = require('../../src/models');

async function insertSecurityPersonnel() {
  try {
    await sequelize.authenticate();
    console.log('✅ 데이터베이스 연결 성공');

    // 정보보호본부 샘플 데이터
    const securityPersonnel = [
      {
        division: '정보보호본부',
        department: '정보보호기술담당',
        position: '담당장',
        employee_number: 'SEC001',
        name: '김보안',
        rank: '부장',
        duties: '정보보호 기술 총괄, 보안 정책 수립',
        job_function: 'SP',
        bok_job_function: '관리자',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1978-03-15',
        gender: '남',
        age: 46,
        group_join_date: '2005-01-10',
        join_date: '2005-01-10',
        total_service_years: 19.8,
        career_base_date: '2005-01-10',
        it_career_years: 19.8,
        current_duty_date: '2020-01-01',
        current_duty_period: 4.9,
        major: '정보보호학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        it_certificate_2: 'CISSP',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호기술담당',
        position: '파트장',
        employee_number: 'SEC002',
        name: '이방화',
        rank: '차장',
        duties: '방화벽 운영 및 관리, 침입탐지 시스템 운영',
        job_function: 'SP',
        bok_job_function: '시스템운영',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1982-07-22',
        gender: '남',
        age: 42,
        group_join_date: '2008-03-15',
        join_date: '2008-03-15',
        total_service_years: 16.6,
        career_base_date: '2008-03-15',
        it_career_years: 16.6,
        current_duty_date: '2021-06-01',
        current_duty_period: 3.4,
        major: '컴퓨터공학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        it_certificate_2: 'CISA',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호기술담당',
        position: '담당자',
        employee_number: 'SEC003',
        name: '박암호',
        rank: '과장',
        duties: '암호화 시스템 관리, 보안키 관리',
        job_function: 'SP',
        bok_job_function: '시스템운영',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1985-11-08',
        gender: '남',
        age: 39,
        group_join_date: '2010-07-01',
        join_date: '2010-07-01',
        total_service_years: 14.3,
        career_base_date: '2010-07-01',
        it_career_years: 14.3,
        current_duty_date: '2022-01-01',
        current_duty_period: 2.8,
        major: '정보보호학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        it_certificate_2: 'CPPG',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호기술담당',
        position: '담당자',
        employee_number: 'SEC004',
        name: '최침입',
        rank: '대리',
        duties: '침입탐지시스템 운영, 보안 로그 분석',
        job_function: 'OP',
        bok_job_function: '시스템운영',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1990-05-14',
        gender: '여',
        age: 34,
        group_join_date: '2015-01-05',
        join_date: '2015-01-05',
        total_service_years: 9.8,
        career_base_date: '2015-01-05',
        it_career_years: 9.8,
        current_duty_date: '2022-07-01',
        current_duty_period: 2.3,
        major: '컴퓨터공학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호기술담당',
        position: '담당자',
        employee_number: 'SEC005',
        name: '정취약',
        rank: '사원',
        duties: '취약점 점검, 보안 패치 관리',
        job_function: 'SP',
        bok_job_function: '정보보호관리',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1995-09-20',
        gender: '남',
        age: 29,
        group_join_date: '2020-03-02',
        join_date: '2020-03-02',
        total_service_years: 4.7,
        career_base_date: '2020-03-02',
        it_career_years: 4.7,
        current_duty_date: '2020-03-02',
        current_duty_period: 4.7,
        major: '정보보안학',
        is_it_major: true,
        it_certificate_1: '정보처리기사',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호관리담당',
        position: '담당장',
        employee_number: 'SEC006',
        name: '강정책',
        rank: '차장',
        duties: '보안 정책 관리, 컴플라이언스 관리',
        job_function: '기타',
        bok_job_function: '정보보호관리',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1983-04-18',
        gender: '여',
        age: 41,
        group_join_date: '2009-05-11',
        join_date: '2009-05-11',
        total_service_years: 15.5,
        career_base_date: '2009-05-11',
        it_career_years: 15.5,
        current_duty_date: '2021-01-01',
        current_duty_period: 3.8,
        major: '경영정보학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        it_certificate_2: 'ISO 27001',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '정보보호관리담당',
        position: '담당자',
        employee_number: 'SEC007',
        name: '윤감사',
        rank: '과장',
        duties: '보안 감사, 내부 통제 점검',
        job_function: '기타',
        bok_job_function: '정보보호관리',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1987-12-05',
        gender: '남',
        age: 37,
        group_join_date: '2012-08-01',
        join_date: '2012-08-01',
        total_service_years: 12.2,
        career_base_date: '2012-08-01',
        it_career_years: 12.2,
        current_duty_date: '2022-03-01',
        current_duty_period: 2.7,
        major: '정보통신학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '보안관제센터',
        position: '센터장',
        employee_number: 'SEC008',
        name: '임관제',
        rank: '차장',
        duties: '24시간 보안관제, 보안사고 대응',
        job_function: 'OP',
        bok_job_function: '시스템운영',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1981-06-30',
        gender: '남',
        age: 43,
        group_join_date: '2007-02-15',
        join_date: '2007-02-15',
        total_service_years: 17.7,
        career_base_date: '2007-02-15',
        it_career_years: 17.7,
        current_duty_date: '2020-07-01',
        current_duty_period: 4.3,
        major: '정보보안학',
        is_it_major: true,
        it_certificate_1: '정보보안기사',
        it_certificate_2: 'CEH',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '보안관제센터',
        position: '담당자',
        employee_number: 'SEC009',
        name: '한모니',
        rank: '대리',
        duties: '보안 모니터링, 이상징후 탐지',
        job_function: 'OP',
        bok_job_function: '시스템운영',
        job_category: '일반직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1992-02-28',
        gender: '여',
        age: 32,
        group_join_date: '2016-07-01',
        join_date: '2016-07-01',
        total_service_years: 8.3,
        career_base_date: '2016-07-01',
        it_career_years: 8.3,
        current_duty_date: '2021-01-01',
        current_duty_period: 3.8,
        major: '컴퓨터공학',
        is_it_major: true,
        it_certificate_1: '정보처리기사',
        is_active: true
      },
      {
        division: '정보보호본부',
        department: '보안관제센터',
        position: '담당자',
        employee_number: 'SEC010',
        name: '오대응',
        rank: '사원',
        duties: '보안사고 1차 대응, 보안 이벤트 분석',
        job_function: 'OP',
        bok_job_function: '시스템운영',
        job_category: '연봉직',
        is_it_personnel: true,
        is_security_personnel: true,
        birth_date: '1996-08-12',
        gender: '남',
        age: 28,
        group_join_date: '2021-01-04',
        join_date: '2021-01-04',
        total_service_years: 3.8,
        career_base_date: '2021-01-04',
        it_career_years: 3.8,
        current_duty_date: '2021-01-04',
        current_duty_period: 3.8,
        major: '정보보호학',
        is_it_major: true,
        it_certificate_1: '정보처리기사',
        is_active: true
      }
    ];

    // 데이터 삽입
    const query = `
      INSERT INTO personnel (
        division, department, position, employee_number, name, rank, duties,
        job_function, bok_job_function, job_category,
        is_it_personnel, is_security_personnel,
        birth_date, gender, age,
        group_join_date, join_date,
        total_service_years, career_base_date, it_career_years,
        current_duty_date, current_duty_period,
        major, is_it_major, it_certificate_1, it_certificate_2,
        is_active, created_at, updated_at
      ) VALUES ${securityPersonnel.map((_, i) => 
        `($${i * 27 + 1}, $${i * 27 + 2}, $${i * 27 + 3}, $${i * 27 + 4}, $${i * 27 + 5}, 
          $${i * 27 + 6}, $${i * 27 + 7}, $${i * 27 + 8}, $${i * 27 + 9}, $${i * 27 + 10},
          $${i * 27 + 11}, $${i * 27 + 12}, $${i * 27 + 13}, $${i * 27 + 14}, $${i * 27 + 15},
          $${i * 27 + 16}, $${i * 27 + 17}, $${i * 27 + 18}, $${i * 27 + 19}, $${i * 27 + 20},
          $${i * 27 + 21}, $${i * 27 + 22}, $${i * 27 + 23}, $${i * 27 + 24}, $${i * 27 + 25},
          $${i * 27 + 26}, $${i * 27 + 27}, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)`
      ).join(', ')}
    `;

    const values = securityPersonnel.flatMap(p => [
      p.division, p.department, p.position, p.employee_number, p.name,
      p.rank, p.duties, p.job_function, p.bok_job_function, p.job_category,
      p.is_it_personnel, p.is_security_personnel,
      p.birth_date, p.gender, p.age,
      p.group_join_date, p.join_date,
      p.total_service_years, p.career_base_date, p.it_career_years,
      p.current_duty_date, p.current_duty_period,
      p.major, p.is_it_major, p.it_certificate_1 || null, p.it_certificate_2 || null,
      p.is_active
    ]);

    await sequelize.query(query, {
      bind: values,
      type: sequelize.QueryTypes.INSERT
    });

    console.log(`✅ ${securityPersonnel.length}명의 정보보호본부 인력 데이터가 추가되었습니다.`);
    console.log('\n추가된 데이터:');
    securityPersonnel.forEach((p, i) => {
      console.log(`${i + 1}. ${p.name} (${p.employee_number}) - ${p.department} ${p.position}`);
    });

  } catch (error) {
    console.error('❌ 오류 발생:', error);
  } finally {
    await sequelize.close();
    console.log('\n✅ 데이터베이스 연결 종료');
  }
}

insertSecurityPersonnel();

