# 인력현황 엑셀 업로드 기능 가이드

## 📋 개요

인력현황 관리 화면에서 엑셀 파일을 업로드하여 인력 데이터를 일괄 등록할 수 있습니다.

## ✨ 주요 기능

1. **엑셀 템플릿 다운로드** - 정확한 형식의 템플릿 제공
2. **엑셀 업로드** - 여러 인력 데이터를 한 번에 등록
3. **자동 데이터 변환** - 날짜, Boolean, 숫자 필드 자동 변환
4. **유효성 검증** - 필수 필드 검증 및 오류 메시지

## 🎯 사용 방법

### 1단계: 템플릿 다운로드

1. 인력현황 관리 화면 접속
2. **"📋 템플릿 다운로드"** 버튼 클릭
3. `인력현황_업로드_템플릿.xlsx` 파일 다운로드

### 2단계: 엑셀 데이터 입력

다운로드한 템플릿을 열어서 데이터를 입력합니다.

#### 필수 입력 필드
- **성명** (필수)

#### 선택 입력 필드
모든 다른 필드는 선택사항이며, 비워두면 NULL로 저장됩니다.

#### 필드 설명

| 필드명 | 타입 | 예시 | 설명 |
|--------|------|------|------|
| 본부 | 텍스트 | 디지털본부 | 소속 본부 |
| 부서 | 텍스트 | IT기획팀 | 소속 부서 |
| 직책 | 텍스트 | 팀장 | 직책 |
| 사번 | 텍스트 | EMP001 | 사번 (중복 불가) |
| 성명 | 텍스트 | 홍길동 | **필수** |
| 직위 | 텍스트 | 부장 | 직위 |
| 담당업무 | 텍스트 | 인사관리 | 담당 업무 |
| 직능 | 텍스트 | IT | 직능 |
| 한국은행직능 | 텍스트 | IT전문가 | 한국은행 직능 분류 |
| 직종구분 | 텍스트 | 정규직 | 직종 구분 |
| 정보기술인력 | O/X | O 또는 X | O, Y, 예, TRUE, 1 → O |
| 정보보호인력 | O/X | X | O, Y, 예, TRUE, 1 → O |
| 생년월일 | 날짜 | 1980-01-01 | YYYY-MM-DD 형식 |
| 성별 | 텍스트 | 남 | 남/여 |
| 나이 | 숫자 | 44 | 나이 |
| 그룹입사일 | 날짜 | 2000-01-01 | YYYY-MM-DD 형식 |
| 입사일 | 날짜 | 2010-01-01 | YYYY-MM-DD 형식 |
| 퇴사일 | 날짜 | 2024-01-01 | YYYY-MM-DD 형식 (퇴사자만) |
| 총재직기간(년) | 숫자 | 14 | 소수점 가능 (예: 14.5) |
| 정산경력기준일 | 날짜 | 2010-01-01 | YYYY-MM-DD 형식 |
| 전산경력 | 숫자 | 10 | 소수점 가능 |
| 현업무발령일 | 날짜 | 2020-01-01 | YYYY-MM-DD 형식 |
| 현업무기간 | 숫자 | 4 | 소수점 가능 |
| 직전소속 | 텍스트 | 이전부서 | 직전 소속 |
| 전공 | 텍스트 | 컴퓨터공학 | 전공 |
| 전산전공여부 | O/X | O | O, Y, 예, TRUE, 1 → O |
| 전산자격증1 | 텍스트 | 정보처리기사 | 자격증 1 |
| 전산자격증2 | 텍스트 | 정보보안기사 | 자격증 2 |
| 전산자격증3 | 텍스트 | | 자격증 3 |
| 전산자격증4 | 텍스트 | | 자격증 4 |
| 비고 | 텍스트 | | 비고 |

### 3단계: 엑셀 업로드

1. 데이터 입력 완료 후 저장
2. 인력현황 관리 화면에서 **"📤 엑셀 업로드"** 버튼 클릭
3. 작성한 엑셀 파일 선택
4. 확인 메시지에서 **"확인"** 클릭
5. 업로드 완료 메시지 확인

## 📌 주의사항

### 파일 형식
- ✅ 지원 형식: `.xlsx`, `.xls`
- ❌ 다른 형식: CSV, TXT 등 불가
- 📏 최대 크기: 10MB

### 데이터 입력 규칙

#### 1. 날짜 형식
```
✅ 올바른 형식: 2024-01-01, 2024-11-28
❌ 잘못된 형식: 2024/01/01, 24-01-01
```

#### 2. Boolean 필드 (O/X)
```
✅ O로 인식: O, Y, 예, TRUE, 1
✅ X로 인식: X, N, 아니오, FALSE, 0, 빈칸
```

#### 3. 숫자 필드
```
✅ 올바른 형식: 14, 14.5, 10.25
❌ 잘못된 형식: 14년, 십사
```

#### 4. 사번 중복
- 사번은 중복될 수 없습니다
- 이미 등록된 사번은 오류 발생

### 오류 처리

#### 오류 발생 시
1. 오류 메시지 확인
2. 엑셀 파일 수정
3. 다시 업로드

#### 주요 오류 메시지
```
❌ "2번째 행: 성명은 필수입니다."
   → 성명 필드를 입력하세요

❌ "파일 크기는 10MB 이하여야 합니다."
   → 파일 크기를 줄이거나 나누어 업로드하세요

❌ "엑셀 파일(.xlsx, .xls)만 업로드 가능합니다."
   → 파일 형식을 확인하세요
```

## 💡 팁

### 대량 데이터 등록
- 한 번에 수백~수천 개 데이터 등록 가능
- 데이터가 많으면 처리 시간이 소요될 수 있음

### 기존 데이터
- 업로드는 **새로운 데이터 추가**만 수행
- 기존 데이터는 변경되지 않음
- 기존 데이터 수정은 개별 수정 기능 사용

### 백업
- 대량 업로드 전 기존 데이터 백업 권장
- 엑셀 다운로드로 현재 데이터 저장 가능

## 🔧 기술 스펙

### 백엔드 API
```
POST /api/personnel/import/excel
Content-Type: multipart/form-data
```

### 사용 라이브러리
- **multer**: 파일 업로드 처리
- **xlsx**: 엑셀 파일 파싱

### 데이터 처리
1. 파일 업로드 → `uploads/` 폴더에 임시 저장
2. 엑셀 파일 읽기 및 JSON 변환
3. 데이터 검증 및 변환
4. DB 트랜잭션으로 일괄 등록
5. 임시 파일 자동 삭제

## 🚀 적용 방법

### 서버 재시작
```bash
pm2 restart cms-server
```

### 브라우저 새로고침
변경사항 적용을 위해 브라우저 새로고침(F5)

## 📞 문의

문제 발생 시:
1. 브라우저 개발자 도구(F12) → Console 확인
2. 서버 로그 확인: `logs/` 폴더
3. 오류 메시지 스크린샷과 함께 문의

---

**작성일**: 2025-11-27  
**버전**: 1.0.0

