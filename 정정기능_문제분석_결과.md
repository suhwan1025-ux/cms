# ğŸ” ì •ì • ê¸°ëŠ¥ ë¬¸ì œ ì§‘ì¤‘ ë¶„ì„ ê²°ê³¼

## âš ï¸ ë°œê²¬ëœ í•µì‹¬ ë¬¸ì œ

### **Sequelize `underscored: true`ì™€ field mapping ì¶©ëŒ**

```javascript
// src/models/Proposal.js (ë¼ì¸ 181-211)
originalProposalId: {
  type: DataTypes.INTEGER,
  allowNull: true,
  field: 'original_proposal_id',  // âš ï¸ ëª…ì‹œì  field ì§€ì •
  comment: 'ì›ë³¸ í’ˆì˜ì„œ ID (ì •ì •ëœ ê²½ìš°)'
},
correctionReason: {
  type: DataTypes.TEXT,
  allowNull: true,
  field: 'correction_reason',  // âš ï¸ ëª…ì‹œì  field ì§€ì •
  comment: 'ì •ì • ì‚¬ìœ '
}

// ëª¨ë¸ ì„¤ì •
{
  sequelize,
  modelName: 'Proposal',
  tableName: 'proposals',
  timestamps: true,
  underscored: true  // âš ï¸ ìë™ snake_case ë³€í™˜ í™œì„±í™”
}
```

### ğŸš¨ **ë¬¸ì œì˜ ì›ì¸**

`underscored: true` ì„¤ì • ì‹œ Sequelize ë™ì‘:
1. **ì €ì¥ ì‹œ**: camelCase ì†ì„±ì„ ìë™ìœ¼ë¡œ snake_caseë¡œ ë³€í™˜
   - `originalProposalId` â†’ `original_proposal_id` âœ…
   - `correctionReason` â†’ `correction_reason` âœ…

2. **ì¡°íšŒ ì‹œ**: DBì˜ snake_caseë¥¼ camelCaseë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
   - í•˜ì§€ë§Œ `field: 'original_proposal_id'`ê°€ ëª…ì‹œë˜ì–´ ìˆìœ¼ë©´...
   - **Sequelizeê°€ ì–´ë–¤ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í• ì§€ ë¶ˆí™•ì‹¤!**

3. **`toJSON()` ì‹œ**: 
   - `underscored: true`ì¸ë° `field`ë¥¼ ëª…ì‹œí•˜ë©´
   - **snake_caseë¡œ ë°˜í™˜ë  ìˆ˜ ìˆìŒ!**

---

## ğŸ“‚ ê´€ë ¨ íŒŒì¼ ë¦¬ìŠ¤íŠ¸

### â­ **ìµœìš°ì„  í™•ì¸ íŒŒì¼ (ë¬¸ì œì˜ í•µì‹¬)**

#### 1. **`src/models/Proposal.js`** ğŸ”´
- **ë¼ì¸ 181-211**: originalProposalId, correctionReason í•„ë“œ ì •ì˜
- **ë¬¸ì œ**: `underscored: true` + ëª…ì‹œì  `field` ì§€ì •ìœ¼ë¡œ ì¸í•œ í‚¤ ë„¤ì´ë° ì¶©ëŒ

#### 2. **`server.js`** ğŸ”´
- **ë¼ì¸ 1920-1975**: POST API - í’ˆì˜ì„œ ìƒì„± (ì €ì¥ ë¡œì§)
- **ë¼ì¸ 2417-2540**: GET `/api/proposals/:id` - í’ˆì˜ì„œ ìƒì„¸ ì¡°íšŒ
- **ë¼ì¸ 2452**: `proposal.toJSON()` - ì—¬ê¸°ì„œ í‚¤ í˜•ì‹ ê²°ì •!
- **ë¼ì¸ 2593-2850**: PUT API - í’ˆì˜ì„œ ìˆ˜ì •

### ğŸŸ¡ **í”„ë¡ íŠ¸ì—”ë“œ ê´€ë ¨ íŒŒì¼**

#### 3. **`src/components/ProposalForm.js`**
- **ë¼ì¸ 59**: correctionReason ì´ˆê¸°ê°’
- **ë¼ì¸ 813-862**: ì •ì • ëª¨ë“œ ë°ì´í„° ë¡œë“œ
- **ë¼ì¸ 834**: sessionStorageì— originalProposalId ì €ì¥
- **ë¼ì¸ 3038, 3044**: ì„œë²„ë¡œ ì „ì†¡ ì‹œ í•„ë“œ í¬í•¨
- **ë¼ì¸ 3052-3053**: ë””ë²„ê¹… ë¡œê·¸
- **ë¼ì¸ 6527-6534**: ì •ì • ì‚¬ìœ  ì…ë ¥ UI

#### 4. **`src/components/ContractList.js`**
- **ë¼ì¸ 1063**: `originalProposalId: data.originalProposalId || data.original_proposal_id` âš ï¸ ì–‘ìª½ ë‹¤ ì²´í¬
- **ë¼ì¸ 1093-1099**: ì›ë³¸ í’ˆì˜ì„œ ì¡°íšŒ
- **ë¼ì¸ 1141**: `correctionReason: enhancedContract.correctionReason || enhancedContract.correction_reason` âš ï¸ ì–‘ìª½ ë‹¤ ì²´í¬
- **ë¼ì¸ 1196-1210**: ì •ì • í’ˆì˜ì„œ ì°¾ê¸°
- **ë¼ì¸ 1218**: originalProposalIdë¥¼ ë¯¸ë¦¬ë³´ê¸°ì— ì „ë‹¬
- **ë¼ì¸ 1287-1293**: ì •ì • í’ˆì˜ì„œì¸ ê²½ìš° ì›ë³¸ ì¡°íšŒ

#### 5. **`src/utils/previewGenerator.js`**
- ì •ì • ê´€ë ¨ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ë³´ê¸°ì— í‘œì‹œí•˜ëŠ” ë¡œì§
- (íŒŒì¼ ë‚´ìš© í™•ì¸ í•„ìš”)

---

## ğŸ” ë¬¸ì œ ì§„ë‹¨ ë°©ë²•

### **1ë‹¨ê³„: API ì‘ë‹µ í˜•ì‹ í™•ì¸**

ì„œë²„ì— ë‹¤ìŒ ë¡œê·¸ ì¶”ê°€ (server.js ë¼ì¸ 2452 ì´í›„):

```javascript
const proposalData = proposal.toJSON();

// ğŸ” ë””ë²„ê¹…: ì‹¤ì œ ë°˜í™˜ í˜•ì‹ í™•ì¸
console.log('ğŸ” toJSON() ê²°ê³¼ í‚¤ í™•ì¸:');
console.log('  originalProposalId:', proposalData.originalProposalId);
console.log('  original_proposal_id:', proposalData.original_proposal_id);
console.log('  correctionReason:', proposalData.correctionReason);
console.log('  correction_reason:', proposalData.correction_reason);
console.log('  ì „ì²´ í‚¤ ëª©ë¡:', Object.keys(proposalData));
```

### **2ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìˆ˜ì‹  í™•ì¸**

ContractList.jsì˜ `handleRowClick` í•¨ìˆ˜ (ë¼ì¸ 1080 ì´í›„):

```javascript
const originalData = await response.json();
console.log('ğŸ” APIì—ì„œ ë°›ì€ ë°ì´í„°:');
console.log('  originalProposalId:', originalData.originalProposalId);
console.log('  original_proposal_id:', originalData.original_proposal_id);
console.log('  correctionReason:', originalData.correctionReason);
console.log('  correction_reason:', originalData.correction_reason);
```

---

## âœ… í•´ê²° ë°©ë²•

### **ë°©ë²• 1: field ì†ì„± ì œê±° (ê¶Œì¥)** â­

`underscored: true`ê°€ ì´ë¯¸ ìë™ ë³€í™˜ì„ í•˜ë¯€ë¡œ, ëª…ì‹œì  `field` ì§€ì •ì„ ì œê±°:

```javascript
// src/models/Proposal.js
originalProposalId: {
  type: DataTypes.INTEGER,
  allowNull: true,
  // field: 'original_proposal_id', // âŒ ì œê±°
  comment: 'ì›ë³¸ í’ˆì˜ì„œ ID (ì •ì •ëœ ê²½ìš°)'
},
correctionReason: {
  type: DataTypes.TEXT,
  allowNull: true,
  // field: 'correction_reason', // âŒ ì œê±°
  comment: 'ì •ì • ì‚¬ìœ '
}
```

**ì¥ì **: Sequelizeê°€ ì¼ê´€ë˜ê²Œ camelCaseë¡œ ì²˜ë¦¬
**ë‹¨ì **: ì—†ìŒ (underscored: trueê°€ ì´ë¯¸ ìë™ ë³€í™˜í•¨)

---

### **ë°©ë²• 2: underscored ì œê±°í•˜ê³  ëª¨ë“  field ëª…ì‹œ**

ëª¨ë¸ ì„¤ì •ì—ì„œ `underscored: false`ë¡œ ë³€ê²½í•˜ê³  ëª¨ë“  í•„ë“œì— `field` ëª…ì‹œ:

```javascript
{
  sequelize,
  modelName: 'Proposal',
  tableName: 'proposals',
  timestamps: true,
  underscored: false  // âœ… ë³€ê²½
}
```

**ì¥ì **: ëª…ì‹œì  ì œì–´
**ë‹¨ì **: ë‹¤ë¥¸ ëª¨ë“  í•„ë“œë„ ìˆ˜ì • í•„ìš”

---

### **ë°©ë²• 3: ì„œë²„ì—ì„œ ëª…ì‹œì  ë³€í™˜ (ì„ì‹œ ë°©í¸)**

GET APIì—ì„œ ë°˜í™˜ ì „ì— í‚¤ ì´ë¦„ ë³€í™˜:

```javascript
// server.js - GET /api/proposals/:id (ë¼ì¸ 2452 ì´í›„)
const proposalData = proposal.toJSON();

// ğŸ”§ ëª…ì‹œì  í‚¤ ë³€í™˜ (snake_case â†’ camelCase)
if (proposalData.original_proposal_id !== undefined && proposalData.originalProposalId === undefined) {
  proposalData.originalProposalId = proposalData.original_proposal_id;
}
if (proposalData.correction_reason !== undefined && proposalData.correctionReason === undefined) {
  proposalData.correctionReason = proposalData.correction_reason;
}
```

**ì¥ì **: ë¹ ë¥¸ ì ìš© ê°€ëŠ¥
**ë‹¨ì **: ê·¼ë³¸ì  í•´ê²°ì´ ì•„ë‹˜

---

## ğŸ¯ **ê¶Œì¥ ì¡°ì¹˜ ìˆœì„œ**

### **ì¦‰ì‹œ ì ìš© (ìš´ì˜ í™˜ê²½)**

1. **server.js**ì— ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€ (ìœ„ì˜ 1ë‹¨ê³„)
2. **ìš´ì˜ í™˜ê²½ ì¬ë°°í¬ ë° ì¬ì‹œì‘**
3. **ì •ì • í’ˆì˜ì„œ ìƒì„± í›„ ë¡œê·¸ í™•ì¸**
4. **ë¡œê·¸ ê²°ê³¼ì— ë”°ë¼ ë°©ë²• 1 ë˜ëŠ” ë°©ë²• 3 ì ìš©**

### **ê·¼ë³¸ í•´ê²° (ê°œë°œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ í›„)**

1. **ë°©ë²• 1 ì ìš©**: `src/models/Proposal.js`ì—ì„œ `field` ì†ì„± ì œê±°
2. **ê°œë°œ í™˜ê²½ì—ì„œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸**
3. **ë¬¸ì œ ì—†ìœ¼ë©´ ìš´ì˜ ë°°í¬**

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì •ì • í’ˆì˜ì„œ ìƒì„± ì‹œ DBì— ê°’ ì €ì¥ í™•ì¸
- [ ] GET APIë¡œ ì¡°íšŒ ì‹œ originalProposalId, correctionReason ë°˜í™˜ í™•ì¸
- [ ] í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°ì´í„° ìˆ˜ì‹  í™•ì¸
- [ ] ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì •ì • ì •ë³´ í‘œì‹œ í™•ì¸
- [ ] ì›ë³¸ í’ˆì˜ì„œ â†’ ì •ì • í’ˆì˜ì„œ ì—°ê²° í™•ì¸
- [ ] ì •ì • í’ˆì˜ì„œ â†’ ì›ë³¸ í’ˆì˜ì„œ ì—°ê²° í™•ì¸

---

## ğŸ”— ê´€ë ¨ ì´ìŠˆ

### ContractList.jsì—ì„œ ë°©ì–´ì  ì½”ë”©

```javascript
// ë¼ì¸ 1063, 1141
originalProposalId: data.originalProposalId || data.original_proposal_id
correctionReason: enhancedContract.correctionReason || enhancedContract.correction_reason
```

â†’ ì´ë¯¸ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ API ì‘ë‹µ í˜•ì‹ì´ ë¶ˆí™•ì‹¤í•¨ì„ ì¸ì§€í•˜ê³  ìˆì—ˆìŒ!

